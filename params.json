{
  "name": "Raspberry-pi-vpn-hotspot",
  "tagline": "Raspberry Pi 3 as VPN Hotspot",
  "body": "# Raspberry Pi 3 Model B as VPN Hotspot - Simple Tutorial\r\n\r\nUsing TP-Link Wi-Fi adapter to connect to my router.\r\nYou can use ethernet instead.\r\nRaspbian Jessie With Pixel - 9/16\r\n\r\nLet's start! (May seem long but... it ain't that much!)\r\n\r\n\r\n**Download first:**\r\n~~~\r\nsudo apt-get update\r\nsudo apt-get install openvpn hostapd isc-dhcp-server\r\n~~~\r\n\r\n\r\n**VPN Setup:**\r\n\r\nI can not help much on this part and you will have to contact your VPN provider for getting the setup ready!\r\nWhy? Cause each provider has different set of configurations.\r\n\r\nBut... some things you should remember:\r\nOnce you have your config and login details, all you need to do (in most cases), copy them to openvpn\r\ndirectory. Then it's easy!\r\n\r\nExample:\r\n~~~\r\nsudo cp ABC.conf /etc/openvpn\r\n~~~\r\n\r\nTest:\r\n~~~\r\nsudo service openvpn start\r\nsudo service openvpn status\r\n~~~\r\nStatus should read \"active\"\r\n\r\n\r\n**DHCP Service:**\r\n~~~\r\nsudo nano /etc/dhcp/dhcpd.conf\r\n~~~\r\nAdd # to below lines:\r\n~~~\r\noption domain-name \"example.org\";\r\noption domain-name-servers ns1.example.org, ns2.example.org;\r\n~~~\r\n\r\nRemove # from this line:\r\n~~~\r\n#authoritative;\r\n~~~\r\n\r\nScroll down to the bottom and add below:\r\n~~~\r\nsubnet 192.168.42.0 netmask 255.255.255.0 {\r\n    range 192.168.42.10 192.168.42.50;\r\n    option broadcast-address 192.168.42.255;\r\n    option routers 192.168.42.1;\r\n    default-lease-time 600;\r\n    max-lease-time 7200;\r\n    option domain-name \"local\";\r\n    option domain-name-servers 8.8.8.8, 8.8.4.4;\r\n}\r\n~~~\r\n~~~\r\nsudo nano /etc/default/isc-dhcp-server\r\n~~~\r\nAdd wlan0 like this:\r\n~~~\r\nINTERFACES=\"wlan0\"\r\n~~~\r\n\r\n\r\n**Network Interfaces:**\r\n~~~\r\nsudo ifdown wlan0\r\nsudo nano /etc/network/interfaces\r\n~~~\r\nConfigure like this:\r\n~~~\r\nauto lo\r\n\r\niface lo inet loopback\r\niface eth0 inet dhcp\r\n\r\nallow-hotplug wlan0\r\n\r\niface wlan0 inet static\r\n  address 192.168.42.1\r\n  netmask 255.255.255.0\r\n  post-up iw dev $IFACE set power_save off\r\n\r\nallow-hotplug wlan1\r\n\r\niface wlan1 inet manual\r\n  wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf\r\n\r\nup iptables-restore < /etc/iptables.nat.vpn.secure\r\n~~~\r\n\r\n\r\n**Assign Static IP to wlan0:**\r\n~~~\r\nsudo ifconfig wlan0 192.168.42.1\r\n~~~\r\n\r\n\r\n**Hostapd:**\r\n\r\n~~~\r\nsudo nano /etc/hostapd/hostapd.conf\r\n~~~\r\nThen fill it like this:\r\n~~~\r\ninterface=wlan0\r\nssid=EXAMPLE\r\nhw_mode=g\r\nchannel=6\r\nmacaddr_acl=0\r\nauth_algs=1\r\nignore_broadcast_ssid=0\r\nwpa=2\r\nwpa_passphrase=STRONG_PASSWORD\r\nwpa_key_mgmt=WPA-PSK\r\nwpa_pairwise=TKIP\r\nrsn_pairwise=CCMP\r\n~~~\r\n~~~\r\nsudo nano /etc/default/hostapd\r\n~~~\r\nRemove # and add /etc/hostapd/hostapd.conf between quotes:\r\n~~~\r\nDAEMON_CONF=\"/etc/hostapd/hostapd.conf\"\r\n~~~\r\n\r\n\r\n**Network Address Translation:**\r\n~~~\r\nsudo nano /etc/sysctl.conf\r\n~~~\r\nLook with care here and remove # from below or add it without # \r\nto the very bottom of the file:\r\n~~~\r\n# net.ipv4.ip_forward=1\r\n~~~\r\n\r\nGet it ready now:\r\n~~~\r\nsudo sh -c \"echo 1 > /proc/sys/net/ipv4/ip_forward\"\r\n~~~\r\n\r\n\r\n**IPTables Rules:**\r\nPay attention here!\r\nCopy and paste below:\r\n~~~\r\nsudo iptables -A INPUT -i tun0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\r\nsudo iptables -A INPUT -i tun0 -j DROP\r\nsudo iptables -t nat -A POSTROUTING -o tun0 -j MASQUERADE\r\nsudo sh -c \"iptables-save > /etc/iptables.nat.vpn.secure\"\r\n~~~\r\n\r\n\r\n**Time to test and start them:**\r\n\r\nHotspot:\r\n~~~\r\nsudo /usr/sbin/hostapd /etc/hostapd/hostapd.conf\r\n~~~\r\nHit Ctrl+C to cancel the test!\r\n\r\nDHCP and Hostapd Test:\r\n~~~\r\nsudo service hostapd start\r\nsudo service isc-dhcp-server start\r\n~~~\r\nCheck their status now:\r\n~~~\r\nsudo service hostapd status\r\nsudo service isc-dhcp-server status\r\n~~~\r\n Make them Auto-Boot on startup:\r\n~~~\r\n sudo update-rc.d hostapd enable\r\n sudo update-rc.d isc-dhcp-server enable\r\n~~~\r\n\r\n\r\n**What are you waiting for?**\r\n~~~\r\nsudo reboot\r\n~~~  \r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}